@model Admin.Model.ViewModel.TransferUserProfileViewModel
@using AzDoc.Helpers
@using AzDoc.App_LocalResources
@using BLL.Models.Document

@{
    ViewBag.Title = "Profil köçürülməsi";
    Layout = "~/Views/Shared/_LeftMenuLayout.cshtml";
    RouteData routeData = ViewContext.RouteData;
    var routeValueDictionary = new RouteValueDictionary(routeData.Values);
    var lang = routeValueDictionary["lang"] ?? "az";
}
<link href="~/Content/jquery-editable-select/jquery-editable-select.min.css" rel="stylesheet" />
<script src="~/Scripts/jquery-editable-select/jquery-editable-select.min.js?v=@AppVersion.Version"></script>
<script src="~/Scripts/common/sweetalert.min.js?v=@AppVersion.Version"></script>
<style>
    .redBorder {
        border-color: red
    }

</style>
<form id="transferForm" name="transferForm">
    <div class="col-12 mainContent">
        <div class="mainEdit contentItem" id="step1" style="padding-top:1px" data-brnum="1">
            <div class="editGroup">
                <h4>Profilin şəxsdən şəxsə köçürülməsi</h4>
                <div class="row" style="padding-top: 20px">

                    <div class="col-sm-4">
                        <div class="form-group">
                            <div class="form-group">
                                <label for="TransferredFromPerson">Kimdən</label>
                                <select id="oldWorkplace" name="oldWorkplace" style="width: 500px" class="form-control selectpicker" data-live-search="true">
                                    <option class="form-control" style="width: 500px">Seç</option>
                                    @foreach (var itemUser in Model.Name)
                                    {
                                        <option class="form-control selectpicker" style="width: 500px"  value="@itemUser.Id">@itemUser.Name</option>
                                    }
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-4">

                        <label for="TransferredToPersons">Kimə</label>
                        <select id="newWorkplace" name="newWorkplace" style="width: 500px" class="form-control selectpicker" data-live-search="true">
                            <option class="form-control" style="width: 500px">Seç</option>
                            @foreach (var itemUser in Model.Name)
                            {
                                <option class="form-control selectpicker" style="width: 500px" value="@itemUser.Id">@itemUser.Name</option>
                            }
                        </select>
                    </div>
                    <div style="padding-top: 20px" class="col-sm-12">
                        <div class="form-group">
                            <div class="form-group">
                                <label for="TransferNote">Qeyd</label>
                                <input type="text" name="DocDocNo" class="form-control" id="DocDocNo" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row mb-5 pb-5 mt-4">
            <div class="col-12 text-center">
                <button type="button" class="mBtn mBtn-sec mr-2" onclick="window.history.go(-1); return false;">
                    @RLang.PrevStep
                </button>
                <button id="submitForm" type="button" class="mBtn mBtn-pr next-step">
                    @RLang.Save
                </button>
            </div>
        </div>
    </div>
    </form>

    <script>
    $(document).on("click", "#submitForm", function ()
    {
        var oldWorkplaceId = $('#oldWorkplace option:selected').val();
        var newWorkplaceId = $('#newWorkplace option:selected').val();

         var message = 'Profildəki sənədlər köçürüldü';
        var values = { oldWorkplaceId: oldWorkplaceId, newWorkplaceId: newWorkplaceId };
        $.ajax({
            url: "/@lang/AdminPanel/OrganizationStructure/ChangeWorkplaceDocs",
            type: 'POST',
            data: JSON.stringify(values) ,
                    dataType: 'Json',
             contentType: "application/json; charset=utf-8",
                    processData: false,
                    success: function (response) {
                        if (response) {

                            toastr.success(message);
                                setTimeout(function () {
                                    window.location.reload();
                                }, 1000);
                        }
                        else {
                            Swal.fire({
                                type: 'error',
                                title: 'Xəta baş verdi',
                                showConfirmButton: false,
                                timer: 1000
                            });
                        }
                    },
                    error: function (response) {
                    },
                    beforeSend: function () {
                        window.ShowLoading();
                    },
                    complete: function () {
                        window.CloseLoading();
                    }
                });



        });

    </script>





