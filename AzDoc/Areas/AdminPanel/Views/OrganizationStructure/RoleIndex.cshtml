@using AzDoc.App_LocalResources
@using AzDoc.Helpers
@using DMSModel

@{
    Layout = "~/Views/Shared/_LeftMenuLayout.cshtml";

    RouteData routeData = ViewContext.RouteData;

    var routeValueDictionary = new RouteValueDictionary(routeData.Values);

    var _lang = routeValueDictionary["lang"] ?? "az";


}
<div class="row no-gutters mt-4">
    <div class="">
        <div class="newRoleBtn">
            <button id="newRole" class="mBtn mBtn-pr" style="width: 100%"> <i class="fas fa-plus">Yeni rol yarat</i></button>
        </div>
    </div>
    <div class="col-3">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="\">Ana səhifə</a></li>
                <li class="breadcrumb-item"><a href="#">Admin</a></li>
                <li class="breadcrumb-item active" aria-current="page">Rollar</li>
            </ol>
        </nav>
    </div>
</div>

<div class="col-md-12" id="DocGrid" style="padding-top: 10px; height: 86vh">
    @Html.Partial("RoleGridViewPartial")
</div>
@section scripts
{
<script>
        $(document).ready(function ()
        {
            $("#newRole").click(function () {
                 window.location.href = '/@_lang/AdminPanel/OrganizationStructure/GetCreateRole';
            });
        });
        function RoleRemove(item, boundData) {
            Swal.fire({
                title: 'Rol silinsinmi?',
                type: 'warning',
                showCancelButton: true,
                cancelButtonText: 'Ləğv et',
                confirmButtonText: 'Təsdiqlə'
            }).then((result) => {
                if (result.value) {
                    var values = { roleId: boundData.RoleId };
             $.ajax({
                 url: '/@_lang/AdminPanel/OrganizationStructure/RemoveRoleById',
                 type: 'POST',
                 data: JSON.stringify(values),
                 contentType: 'application/json; charset=utf-8',
                 success: function (response) {
                     if (response) {
                         Swal.fire({
                             type: 'success',
                             title: 'Rol silindi',
                             showConfirmButton: false,
                             timer: 1000
                         });
                         window.location.reload();

                     }
                     else
                     {
                         Swal.fire({
                             type: 'error',
                             title: 'Xəta baş verdi',
                             showConfirmButton: false,
                             timer: 1000
                         });
                     }
                 },
                 beforeSend: function () {
                     window.ShowLoading();
                 },
                 complete: function () {
                     window.CloseLoading();
                 }
             });

                }
            });

        }



        function UserView(item, boundData) {
            window.open('/az/AdminPanel/OrganizationStructure/GetUserView?userId=' + boundData.UserId, '_blank');
        }

        function onFilter(sender, args, query) {
            $('#gridOrganizationStructure').bindgrid(1);

    }

    //BU FUNKSIYA BIRBASA GRIDIN ICERISINDEN CAGIRILIR
    function RoleEdit(item, boundData) {
        window.location.href = '/@_lang/AdminPanel/OrganizationStructure/GetEditRole?roleId=' + boundData.RoleId;
    }

</script>
    <script src="~/Scripts/common/sweetalert.min.js?v=@AppVersion.Version"></script>

}
